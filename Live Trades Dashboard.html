<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>LTP SCALPER | Trading Dashboard</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- ðŸ” LOGIN PROTECTION (DO NOT REMOVE) -->
<script>
if (localStorage.getItem("ltp_logged_in") !== "true") {
  window.location.href = "index.html";
}
</script>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">

<style>
:root{
  --orange:#ff8c00;
  --light-orange:#ffb703;
  --light-yellow:#fff6db;
  --dark:#222;
}

*{box-sizing:border-box}

body{
  margin:0;
  font-family:Poppins,sans-serif;
  background:#fff;
  color:var(--dark);
  overflow-x:hidden;
}

/* ---------- HEADER ---------- */
header{
  background:#fff;
  border-bottom:2px solid var(--light-orange);
  padding:16px;
}

.brand{
  display:flex;
  align-items:center;
  gap:12px;
  flex-wrap:wrap;
}

.brand h1{
  margin:0;
  font-size:22px;
  font-weight:700;
  color:var(--orange);
  display:flex;
  align-items:center;
  gap:8px;
}

/* LIVE DOT */
.live-dot{
  width:10px;
  height:10px;
  background:#e53935;
  border-radius:50%;
  display:none
}
.blink{animation:blink 1s infinite}
@keyframes blink{
  0%{opacity:1}
  50%{opacity:.2}
  100%{opacity:1}
}

/* TAGLINE */
.tagline{
  font-size:12px;
  font-weight:600;
  color:#444;
  background:#fff6db;
  padding:5px 12px;
  border-radius:20px;
  border:1px solid #ffb703;
}

/* MARKET BADGE */
.market-badge{
  font-size:11px;
  font-weight:700;
  padding:5px 12px;
  border-radius:20px;
  color:#fff;
}

.preopen{background:#f39c12}
.open{background:#2ecc71}
.post{background:#9b59b6}
.closed{background:#e74c3c}

.countdown{
  font-size:11px;
  font-weight:600;
  color:#555;
}

/* LOGOUT */
.logout-btn{
  margin-left:auto;
  background:#e74c3c;
  color:#fff;
  border:none;
  padding:7px 14px;
  border-radius:20px;
  font-size:11px;
  font-weight:600;
  cursor:pointer;
}

/* ---------- SUMMARY ---------- */
.summary{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(180px,1fr));
  gap:14px;
  padding:16px;
}

.card{
  background:var(--light-yellow);
  padding:16px;
  border-radius:16px;
  box-shadow:0 10px 25px rgba(0,0,0,0.08);
}

.card h4{margin:0;font-size:12px;color:#666}
.card h2{margin-top:6px;font-size:24px;color:var(--orange)}
.card.pl-plus h2{color:#2ecc71}
.card.pl-minus h2{color:#e74c3c}

/* ---------- TABS ---------- */
.tabs{
  display:flex;
  gap:10px;
  padding:12px 16px;
  flex-wrap:wrap;
}

.tab{
  padding:8px 18px;
  border-radius:25px;
  border:2px solid var(--orange);
  cursor:pointer;
  font-weight:600;
  color:var(--orange);
  font-size:13px;
}

.tab.active{
  background:var(--orange);
  color:#fff;
}

/* ---------- TABLE WRAPPER (IMPORTANT FIX) ---------- */
.container{
  padding:0 16px 40px;
}

.table-wrap{
  width:100%;
  overflow-x:auto;
  -webkit-overflow-scrolling:touch;
  border-radius:14px;
}

table{
  min-width:820px; /* ðŸ‘ˆ mobile scroll fix */
  width:100%;
  border-collapse:collapse;
  background:#fff;
  box-shadow:0 12px 30px rgba(0,0,0,0.08);
}

th{
  background:var(--orange);
  color:#fff;
  padding:12px;
  font-size:13px;
}

td{
  padding:12px;
  text-align:center;
  font-size:13px;
}

tr:nth-child(even){background:var(--light-yellow)}

.status{
  padding:5px 12px;
  border-radius:20px;
  font-size:11px;
  color:#fff;
  font-weight:600;
}

.LIVE{background:#ff9800}
.CLOSED{background:#607d8b}
.TARGET{background:#2ecc71}
.SL{background:#e74c3c}
.hidden{display:none}

/* ---------- FOOTER ---------- */
footer{
  text-align:center;
  padding:14px;
  font-size:11px;
  color:#777;
  border-top:1px solid #eee;
}

/* ---------- MOBILE EXTRA ---------- */
@media(max-width:600px){
  .brand{
    flex-direction:column;
    align-items:flex-start;
  }
  .logout-btn{
    margin-left:0;
    margin-top:6px;
  }
}
</style>
</head>

<body>

<header>
  <div class="brand">
    <h1>LTP SCALPER <span id="liveDot" class="live-dot"></span></h1>
    <div class="tagline">Live Trade â€¢ Indian Stock Market</div>
    <div id="marketBadge" class="market-badge">Checkingâ€¦</div>
    <div id="countdown" class="countdown"></div>
    <button class="logout-btn" onclick="logout()">Logout</button>
  </div>
</header>

<div class="summary">
  <div class="card">
    <h4>Total Trades</h4>
    <h2 id="totalTrades">0</h2>
  </div>
  <div class="card" id="plCard">
    <h4>Day P/L</h4>
    <h2 id="dayPL">â‚¹0</h2>
  </div>
</div>

<div class="tabs">
  <div class="tab active" onclick="showTab('live',this)">LIVE TRADES</div>
  <div class="tab" onclick="showTab('closed',this)">CLOSED TRADES</div>
</div>

<div class="container">

<div class="table-wrap">
<table id="liveTable">
<thead>
<tr>
<th>Symbol</th><th>Type</th><th>Entry</th><th>Target</th><th>SL</th>
<th>Lots</th><th>Qty</th><th>Status</th>
</tr>
</thead>
<tbody></tbody>
</table>
</div>

<div class="table-wrap">
<table id="closedTable" class="hidden">
<thead>
<tr>
<th>Symbol</th><th>Type</th><th>Entry</th><th>Exit</th>
<th>Lots</th><th>Qty</th><th>P/L</th><th>Result</th><th>Status</th>
</tr>
</thead>
<tbody></tbody>
</table>
</div>

</div>

<footer>
Â© 2026 <strong>Credvantage Financial Advisory Pvt. Ltd.</strong><br>
All trades are for educational purposes only.
</footer>

<!-- JS SAME AS YOUR ORIGINAL (NO CHANGE) -->
<script>
function logout(){
  localStorage.clear();
  window.location.href="index.html";
}
</script>

<script>
function fmt(sec){
  const h=Math.floor(sec/3600);
  const m=Math.floor((sec%3600)/60);
  const s=Math.floor(sec%60);
  return `${String(h).padStart(2,'0')}:${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`;
}

function updateMarket(){
  const now=new Date(new Date().toLocaleString("en-US",{timeZone:"Asia/Kolkata"}));
  const day=now.getDay();
  const badge=marketBadge;
  const dot=liveDot;
  const cd=countdown;

  dot.style.display="none";
  dot.classList.remove("blink");
  cd.innerText="";

  if(day===0||day===6){
    badge.className="market-badge closed";
    badge.innerText="MARKET CLOSED";
    return;
  }

  const openT=new Date(now);openT.setHours(9,15,0,0);
  const closeT=new Date(now);closeT.setHours(15,30,0,0);

  if(now<openT){
    badge.className="market-badge preopen";
    badge.innerText="PRE-OPEN";
    cd.innerText=`Market opens in ${fmt((openT-now)/1000)}`;
  }else if(now<closeT){
    badge.className="market-badge open";
    badge.innerText="MARKET OPEN";
    dot.style.display="inline-block";
    dot.classList.add("blink");
    cd.innerText=`Market closes in ${fmt((closeT-now)/1000)}`;
  }else{
    badge.className="market-badge post";
    badge.innerText="POST-MARKET";
  }
}
updateMarket();
setInterval(updateMarket,1000);
</script>

<script>
const API="https://script.google.com/macros/s/AKfycbwR38Ai6MGtf-ftAvOijHND1ornYWrwWDSoXCO0s86DVI_p7tZqE8MnGWZWq_iW0AVy_A/exec";
let liveCount=0,closedCount=0,totalPL=0;

function showTab(tab,el){
  document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
  el.classList.add('active');
  liveTable.classList.toggle("hidden",tab!=="live");
  closedTable.classList.toggle("hidden",tab!=="closed");
}

function loadLive(){
fetch(API+"?action=live").then(r=>r.json()).then(d=>{
liveCount=d.length;updateSummary();
liveTable.querySelector("tbody").innerHTML=d.map(t=>`
<tr>
<td>${t.symbol}</td><td>${t.type}</td><td>${t.entry}</td>
<td>${t.target}</td><td>${t.sl}</td>
<td>${t.lots}</td><td>${t.qty}</td>
<td><span class="status LIVE">LIVE</span></td>
</tr>`).join("");
});
}

function loadClosed(){
fetch(API+"?action=closed").then(r=>r.json()).then(d=>{
closedCount=d.length;totalPL=0;
closedTable.querySelector("tbody").innerHTML=d.map(t=>{
totalPL+=Number(t.pl);
return`
<tr>
<td>${t.symbol}</td><td>${t.type}</td><td>${t.entry}</td>
<td>${t.exit}</td><td>${t.lots}</td><td>${t.qty}</td>
<td style="font-weight:700;color:${t.pl>=0?'#2ecc71':'#e74c3c'}">${t.pl}</td>
<td><span class="status ${t.result}">${t.result}</span></td>
<td><span class="status CLOSED">CLOSED</span></td>
</tr>`}).join("");
updateSummary();
});
}

function updateSummary(){
totalTrades.innerText=liveCount+closedCount;
dayPL.innerText="â‚¹"+totalPL.toFixed(0);
plCard.classList.remove("pl-plus","pl-minus");
if(totalPL>0)plCard.classList.add("pl-plus");
if(totalPL<0)plCard.classList.add("pl-minus");
}

loadLive();loadClosed();
setInterval(loadLive,5000);
setInterval(loadClosed,5000);
</script>

</body>
</html>
